<!DOCTYPE html>
<html>
<head>
    <title>Google Slides Input</title>
    <script src="https://apis.google.com/js/api.js"></script>
</head>
<body>
    <h1>Populate Google Slides Template</h1>
    <form id="input-form">
        <label for="word">Enter a word:</label><br>
        <input type="text" id="word" name="word"><br><br>
        <input type="submit" value="Submit">
    </form>

    <script>
        const CLIENT_ID = '168113913917-ba66d01893k4nvpp24ivschtj4aqddl2.apps.googleusercontent.com';
        const API_KEY = 'AIzaSyCbxqpuOJJWbr0usCY2jbeQAJY4LvLKlGY';
        const DISCOVERY_DOCS = ["https://slides.googleapis.com/$discovery/rest?version=v1"];
        const SCOPES = "https://www.googleapis.com/auth/presentations https://www.googleapis.com/auth/drive.file";

        function handleClientLoad() {
            gapi.load('client:auth2', initClient);
        }

        function initClient() {
            gapi.client.init({
                apiKey: API_KEY,
                clientId: CLIENT_ID,
                discoveryDocs: DISCOVERY_DOCS,
                scope: SCOPES
            }).then(() => {
                document.getElementById('input-form').addEventListener('submit', handleFormSubmit);
            });
        }

        function handleFormSubmit(event) {
            event.preventDefault();
            const word = document.getElementById('word').value;
            populateSlide(word);
        }

        function populateSlide(word) {
            gapi.auth2.getAuthInstance().signIn().then(() => {
                const templatePresentationId = '1RfpmUhs1Rcv1LpmikmbhQYlFKtuFsKuZq13bEpFHgEM';
                const requests = [
                    {
                        insertText: {
                            objectId: 'g2f0197cd1a9_0_79',
                            insertionIndex: 0,
                            text: word
                        }
                    }
                ];

                gapi.client.slides.presentations.batchUpdate({
                    presentationId: templatePresentationId,
                    resource: { requests: requests }
                }).then(() => {
                    alert('Slide updated with word: ' + word);
                });
            });
        }

        document.addEventListener('DOMContentLoaded', handleClientLoad);
    </script>
</body>
</html>
